import pandas as pd
import os

def split_csv_by_initializer(folder_path):
    # Ensure the folder exists
    if not os.path.isdir(folder_path):
        print(f"The path {folder_path} is not a valid directory.")
        return

    # Get all CSV files in the folder
    csv_files = [f for f in os.listdir(folder_path) if f.endswith('.csv')]

    if not csv_files:
        print("No CSV files found in the specified directory.")
        return

    # Create output directory if it doesn't exist
    output_dir = "split_csv_files"
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)

    for csv_file in csv_files:
        file_path = os.path.join(folder_path, csv_file)
        df = pd.read_csv(file_path)

        # Get unique initializers
        initializers = df['initializer'].unique()

        # Split the dataframe by initializer and save each to a separate CSV file
        for initializer in initializers:
            initializer_df = df[df['initializer'] == initializer]
            base_filename = os.path.splitext(csv_file)[0]
            output_file = os.path.join(output_dir, f"{base_filename}_{initializer}.csv")
            if os.path.exists(output_file):
                # Append to the existing file
                initializer_df.to_csv(output_file, mode='a', header=False, index=False)
            else:
                # Create a new file
                initializer_df.to_csv(output_file, index=False)
            print(f"Saved {output_file}")

if __name__ == "__main__":
    folder_path = input("Enter the path to the directory containing the CSV files: ")
    split_csv_by_initializer(folder_path)
